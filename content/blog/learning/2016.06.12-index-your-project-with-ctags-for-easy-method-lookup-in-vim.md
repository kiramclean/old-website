+++
date = "2016-06-12T10:21:13-04:00"
title = "index your project with ctags for easy method lookup in vim"
+++

Ruby code, especially in Rails projects, tends to be spread out over lots of different files. This is great for organization and makes separating concerns and building nice re-usable modules simpler, but also has the downside of making the code hard to follow, especially if you're new to a project. The solution to this is to index your project so you can lookup any method definition or variable declaration with a keyboard shortcut. Sublime comes with this feature built-in, but some other text editors don't. It's one of the things I missed a lot when I switched to vim, but luckily it's not that hard to get back. To index your project for vim you'll need to generate a tags file with ctags and then tell vim how to use it. Right now [ctags supports 41 languages](http://ctags.sourceforge.net/languages.html), so this isn't just for Ruby developers. Here's how to get it up and running.

## Get `ctags`

First you'll need exuberant-ctags if you don't already have it. If you use homebrew you can just run
```bash
brew install ctags
```
or head over to [the ctags website](http://ctags.sourceforge.net/) to download the source code.

## Generate the Tags File

Next, `cd` into your project root directory and generate the tags. The command to do this is
```bash
ctags -R .
```

The R is for recursive. This will crawl through every directory in your project and index the methods, variables, class names, and other identifiers in your code.

> ### Issues with the `ctags` executable
OSX comes with a `ctags` executable, but it doesn't parse ruby code. You need to make sure your `ctags` executable is using exuberant ctags installed by homebrew, not the system `ctags` command. If you run into issues and the command above doesn't seem to be working try using `` `brew--prefix`/bin/ctags`` instead of `ctags` as your executable, to make sure you're running exuberant ctags installed by homebrew.


You can also pass other flags to the command to customize your tags file. This is the full command I run to generate tags for my projects:

```bash
`brew --prefix`/bin/ctags -R --exclude=.git --exclude=log *
```

That way it doesn't generate indexes for any git or log files. You can add these custom configuration options to a `~/.ctags` file to make them the defaults or create an alias for the command with your custom flags. There are also tons of other options if you need your tags to behave in some special way. Run `ctags --help` for a full list.

If you're thinking "I don't want to have to regenerate my tags manually all the time", you don't have to. If you want to you can [set up some git hooks](http://smartic.us/2009/04/03/creating-ctags-with-git-hooks/) to automatically generate tags when you commit, push, or do some other things with git.

You probably also want to add `tags` to your `.gitignore`. Not everybody on your team will need the `tags` file and even if they do, it's better to generate it locally to prevent conflicts from custom configurations.

## Now Jump Around Effortlessly in Vim

The default mapping for "goto tag" is `<C-]>` in vim. By default this will replace your current view with the definition of the method or variable that your cursor is over. I found this kind of annoying and wanted to get vim to open the tag definition beside my current view, so I have this mapping in my `~/.vimrc`:

```vim
map <C-\> :sp<CR>:exec("tag ".expand("<cword>"))<CR>
```

`:tag method_name` is how you jump to to the definition of a method you know, so this makes vim open the definition of the method or variable under my cursor in a new split, so I can see the original context and the definition at the same time. Of course you can bind whatever key mappings you want. There are also lots of other things you can do with tags in vim. To learn more run the vim command `:help tag`.

## Also Take Advantage of Vim’s “goto file”
As long as we're talking about easy file navigation, vim does come with one sort-of indexing feature built in: `gf`. The mnemonic is “goto file”. It replaces your current view with the file whose name is under or after the cursor when you hit `gf`. It's not the quite the same thing as a real index because of course it only works with file names, but for rails projects where the file almost always has the same name as the class it contains, this works pretty smoothly. Again, I don't like losing my current context when I want to go to another file, so I mapped `<C-g>` to take me to the file under my cursor in a new tab:

```vim
map <silent> <C-g> <C-w>gf
```
## Enjoy!

Learning how to navigate through your project files quickly is one of the best ways to code faster. Indexing is just one of many ways to speed things up. Hopefully this helps to streamline your workflow and speed up your development. Happy coding :).
