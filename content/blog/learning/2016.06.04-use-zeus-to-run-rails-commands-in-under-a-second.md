+++
date = "2016-06-04T11:19:34-04:00"
title = "Use Zeus To Run Rails Commands In Under a Second"
+++

I love Rails but it can be slow. Usually it's a not a problem and I just leave a console and server running in extra terminal windows, but there isn't really a workaround like this for running tests or rake tasks. You might not notice a lag on a powerful machine, but on an old MacBook Air like I use at work it can take over 15 seconds to load all the files that are necessary for a test or rake task run in a decent sized Rails project. That's too long to wait if you want to integrate testing into your normal workflow, as you might if you're doing test-driven development. 15 seconds might not sound like a lot, but it breaks my concentration and flow when I'm running focused tests. To fix this problem I highly recommend using zeus, a gem that pre-loads your rails app and keeps it running so that your commands run in less than a second.

## Install and Run Zeus

To get started, install zeus globally. Not in your project's Gemfile - it runs outside of your rails app.

```ruby
gem install zeus
```

If you use rspec, then there you're all set. To use zeus, first start it in a terminal window in your project's root directory with

```ruby
zeus start
```

And then prepend your commands with `zeus`. So `rake db:migrate` becomes `zeus rake db:migrate`, and so on. That's it! Try it out and tell me it's not awesome. I added aliases for commands like these so typing an extra `zeus` doesn't get in the way. Think about adding `alias zrake='zeus rake'` or something similar to make zeus even faster.

## Custom Configuration

If you want some control over how zeus runs and which commands it takes you can run `zeus init` in your project directory, which will generate two config files `zeus.json` and `custom_plans.rb`. You can change the aliases and commands zeus uses by customizing `zeus.json`. Custom plans are for setting up zeus to run other commands, like cucumber.

## Debugging

If you run into issues, like zeus not starting or not running your commands as expected, it can be tricky to figure out what went wrong. As much as I love zeus, some of the error messages it throws can be less than helpful for troubleshooting. What is `exit status 1` supposed to mean? If zeus booted your app but failed to load all of the commands, you're in a pretty good spot. Follow the crash message's advice and run a command to see the backtrace -- it should give you a pretty good clue about what went wrong. If you just get a zeus error message, like `exit status 1`, after it fails to start, it can be harder to pinpoint the problem. This happens to me all the time, so here are few different things that have worked to get me unstuck:

- First, make sure everything actually is working. Try running `rails s`, `rails c`, `rake something` or some other command that zeus failed to load and make sure they're working as normal. If they're not, fix the issue and re-try zeus. Make sure your database server is running, if you need one, and make sure there are no pending migrations.
- Triple check your `zeus.json` and `custom_plan.rb` for syntax errors to make sure there aren't any.
- Make sure you have either both `zeus.json` and `custom_plan.rb` or neither of them in your project directory. Having only one without the other can cause problems.
- Force your rails helper to use the test environment instead of defaulting to the current environment:

>```ruby
# at the top of spec/rails_helper.rb
ENV['RAILS_ENV'] = 'test'
```

- Make sure you don't have auto-running enabled. Check for `require 'rspec/autorun'` or `require 'rspec/autotest'` in your project and remove those lines if you find them.
- Double check in `./bundle/bin/` to make sure you don't have a `zeus` binstub in there. Delete it if there is one. This could happen if you ever had zeus in your Gemfile and can cause zeus to fail.

## Accelerate Your Rails Development

Ever since I started using zeus I can't imagine not using it to run my specs and rake commands. It's definitely improved my workflow and saves me a lot of time throughout the day. I'm always looking for faster ways to get things done, especially with Rails, so if you know of any let me know. Hopefully this is something that can help your workflow. Happy coding!
